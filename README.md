# è±†ç“£å½±è¯„æƒ…æ„Ÿåˆ†æç³»ç»Ÿ

åŸºäºæœ´ç´ è´å¶æ–¯ç®—æ³•å®ç°çš„ä¸­æ–‡å½±è¯„æƒ…æ„Ÿåˆ†æå·¥å…·ï¼Œèƒ½å¤Ÿè‡ªåŠ¨åˆ¤æ–­å½±è¯„æ–‡æœ¬çš„æƒ…æ„Ÿå€¾å‘ï¼ˆæ­£é¢/è´Ÿé¢ï¼‰ã€‚

## ğŸ“– é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®ä½¿ç”¨æœºå™¨å­¦ä¹ ä¸­çš„æœ´ç´ è´å¶æ–¯ç®—æ³•ï¼Œç»“åˆTF-IDFç‰¹å¾æå–æŠ€æœ¯ï¼Œæ„å»ºäº†ä¸€ä¸ªä¸“é—¨ç”¨äºåˆ†æè±†ç“£å½±è¯„æƒ…æ„Ÿçš„åˆ†ç±»ç³»ç»Ÿã€‚ç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«å½±è¯„æ–‡æœ¬ä¸­çš„æƒ…æ„Ÿå€¾å‘ï¼Œä¸ºç”µå½±æ¨èã€ç”¨æˆ·è¡Œä¸ºåˆ†æç­‰åº”ç”¨æä¾›æ”¯æŒã€‚

### ğŸ¯ ä¸»è¦ç‰¹æ€§

- **é«˜å‡†ç¡®ç‡**: åœ¨æµ‹è¯•é›†ä¸Šè¾¾åˆ°çº¦80%çš„åˆ†ç±»å‡†ç¡®ç‡
- **ä¸­æ–‡ä¼˜åŒ–**: ä¸“é—¨é’ˆå¯¹ä¸­æ–‡æ–‡æœ¬è¿›è¡Œä¼˜åŒ–ï¼Œæ”¯æŒjiebaåˆ†è¯
- **è‡ªå®šä¹‰è¯å…¸**: æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¯å…¸ï¼Œæé«˜ç‰¹å®šé¢†åŸŸè¯æ±‡çš„è¯†åˆ«å‡†ç¡®æ€§
- **åœç”¨è¯è¿‡æ»¤**: å†…ç½®åœç”¨è¯è¿‡æ»¤æœºåˆ¶ï¼Œæé«˜ç‰¹å¾è´¨é‡
- **æ˜“äºä½¿ç”¨**: æä¾›ç®€æ´çš„APIæ¥å£ï¼Œæ–¹ä¾¿é›†æˆåˆ°å…¶ä»–é¡¹ç›®ä¸­

### ğŸ“Š æ•°æ®é›†ä¿¡æ¯

- **æ•°æ®æ¥æº**: è±†ç“£Top250ç”µå½±æ’è¡Œæ¦œä¸­çš„ç”¨æˆ·å½±è¯„
- **æ•°æ®è§„æ¨¡**: çº¦50,000æ¡å½±è¯„æ•°æ®
- **æ•°æ®å¹³è¡¡**: æ­£é¢è¯„è®ºå’Œè´Ÿé¢è¯„è®ºå„å 50%
- **æ•°æ®è·å–**: åŸºäºScrapyæ¡†æ¶çˆ¬å–ï¼ˆ[çˆ¬è™«é¡¹ç›®åœ°å€](https://github.com/3inchtime/douban_movie_review)ï¼‰
- **æ•°æ®åˆ’åˆ†**: è®­ç»ƒé›†:æµ‹è¯•é›† = 4:1

### ğŸ” ç®—æ³•åŸç†

æœ¬é¡¹ç›®é‡‡ç”¨å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨ï¼Œç»“åˆTF-IDFç‰¹å¾æå–ï¼š

1. **æ–‡æœ¬é¢„å¤„ç†**: å»é™¤URLã€ç‰¹æ®Šå­—ç¬¦ï¼ŒæŒ‰æ ‡ç‚¹ç¬¦å·åˆ†å¥
2. **ä¸­æ–‡åˆ†è¯**: ä½¿ç”¨jiebaåˆ†è¯å™¨è¿›è¡Œä¸­æ–‡åˆ†è¯
3. **åœç”¨è¯è¿‡æ»¤**: è¿‡æ»¤æ— æ„ä¹‰çš„åœç”¨è¯
4. **ç‰¹å¾æå–**: ä½¿ç”¨TF-IDFç®—æ³•æå–æ–‡æœ¬ç‰¹å¾
5. **æ¨¡å‹è®­ç»ƒ**: ä½¿ç”¨å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ç®—æ³•è®­ç»ƒåˆ†ç±»å™¨
6. **æƒ…æ„Ÿé¢„æµ‹**: è¾“å‡ºæ­£é¢å’Œè´Ÿé¢æƒ…æ„Ÿçš„æ¦‚ç‡

### âš ï¸ æ¨¡å‹å±€é™æ€§

ç”±äºç”µå½±è¯„è®ºçš„å¤æ‚æ€§ï¼Œéƒ¨åˆ†å¥½è¯„ä¸­å¯èƒ½åŒ…å«è´Ÿé¢æƒ…æ„Ÿè¯æ±‡ã€‚ä¾‹å¦‚çºªå½•ç‰‡ã€Šæµ·è±šæ¹¾ã€‹çš„è¯„è®ºï¼š

> æˆ‘è§‰å¾—å¤§éƒ¨åˆ†çœ‹æœ¬ç‰‡ä¼šæœ‰æ„Ÿçš„äººï¼Œéƒ½ä¸çŸ¥é“ï¼Œä¸­å›½çš„ç™½æš¨è±šå·²ç»ç­ç»8å¹´äº†ï¼Œä¹Ÿä¸ä¼šçŸ¥é“ï¼Œé•¿æ±Ÿé‡Œçš„æ±Ÿè±šä¹Ÿä»…å‰©1000å·¦å³äº†ã€‚ä¸å…¶æ„Ÿæ…¨ï¼Œå’’éª‚æ—¥æœ¬äººå¦‚ä½•æ•æ€æµ·è±šï¼Œä¸å¦‚åšäº›å®é™…çš„äº‹æƒ…ï¼Œä¿æŠ¤ä¸€ä¸‹é•¿æ±Ÿé‡Œçš„æ±Ÿè±šå§ï¼Œæ²¡å‡ å¹´ï¼Œä¹Ÿå°†ç»è¿¹äº†ã€‚ä¸­å›½äººåšå‡ºæ¥çš„äº‹æƒ…ï¼Œä¹Ÿä¸ä¼šæ¯”å°æ—¥æœ¬å¥½åˆ°å“ªå„¿å»ã€‚

è¿™ç±»è¯„è®ºè™½ç„¶åŒ…å«è´Ÿé¢è¯æ±‡ï¼Œä½†æ•´ä½“æƒ…æ„Ÿå€¾å‘æ˜¯æ­£é¢çš„ã€‚é€šè¿‡æ•°æ®æ¸…æ´—å’Œç‰¹å¾å·¥ç¨‹ä¼˜åŒ–ï¼Œå¯ä»¥è¿›ä¸€æ­¥æé«˜æ¨¡å‹å‡†ç¡®ç‡ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.6+
- jieba
- scikit-learn
- numpy
- pandas (å¯é€‰ï¼Œç”¨äºæ•°æ®å¤„ç†)

### å®‰è£…ä¾èµ–

```bash
pip install jieba scikit-learn numpy
```

### é¡¹ç›®ç»“æ„

```
douban_sentiment_analysis/
â”œâ”€â”€ data/                              # æ•°æ®æ–‡ä»¶å¤¹
â”‚   â”œâ”€â”€ review.csv                     # å½±è¯„æ•°æ®é›†
â”‚   â”œâ”€â”€ stopwords.txt                  # åœç”¨è¯åˆ—è¡¨
â”‚   â”œâ”€â”€ userdict.txt                   # ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸
â”‚   â””â”€â”€ bayes.pkl                      # è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆè®­ç»ƒåç”Ÿæˆï¼‰
â”œâ”€â”€ native_bayes_sentiment_analyzer.py # æƒ…æ„Ÿåˆ†æå™¨æ ¸å¿ƒç±»
â”œâ”€â”€ native_bayes_train.py              # æ¨¡å‹è®­ç»ƒè„šæœ¬
â”œâ”€â”€ native_bayes_test.py               # æ¨¡å‹æµ‹è¯•è„šæœ¬
â”œâ”€â”€ run_test.py                        # ä½¿ç”¨ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ native_bayes.ipynb                 # Jupyter Notebookæ¼”ç¤º
â””â”€â”€ README.md                          # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸ“ ä½¿ç”¨æ–¹æ³•

### 1. è®­ç»ƒæ¨¡å‹

é¦–æ¬¡ä½¿ç”¨éœ€è¦å…ˆè®­ç»ƒæ¨¡å‹ï¼š

```bash
python native_bayes_train.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.570 seconds.
Prefix dict has been built succesfully.
è®­ç»ƒé›†æ•°é‡ï¼š 40906
æµ‹è¯•é›†æ•°é‡ï¼š 10226
è®­ç»ƒå®Œæˆ
```

### 2. æµ‹è¯•æ¨¡å‹æ€§èƒ½

```bash
python native_bayes_test.py
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
Building prefix dict from the default dictionary ...
Loading model from cache /tmp/jieba.cache
Loading model cost 0.572 seconds.
Prefix dict has been built succesfully.
è®­ç»ƒé›†æ•°é‡ï¼š 40906
æµ‹è¯•é›†æ•°é‡ï¼š 10226
æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š 0.8043380027112517
```

### 3. ä½¿ç”¨æƒ…æ„Ÿåˆ†æå™¨

#### åŸºæœ¬ä½¿ç”¨

```python
from native_bayes_sentiment_analyzer import SentimentAnalyzer

# é…ç½®æ–‡ä»¶è·¯å¾„
model_path = './data/bayes.pkl'
userdict_path = './data/userdict.txt'
stopword_path = './data/stopwords.txt'

# åˆ›å»ºåˆ†æå™¨å®ä¾‹
analyzer = SentimentAnalyzer(
    model_path=model_path,
    userdict_path=userdict_path,
    stopword_path=stopword_path
)

# åˆ†ææ–‡æœ¬æƒ…æ„Ÿ
text = "è¿™éƒ¨ç”µå½±çœŸçš„å¾ˆæ£’ï¼Œæ¼”å‘˜æ¼”æŠ€ç²¾æ¹›ï¼Œå‰§æƒ…å¼•äººå…¥èƒœï¼"
analyzer.analyze(text)
# è¾“å‡º: å·®è¯„ï¼š 0.123 å¥½è¯„ï¼š 0.877
```

#### æ‰¹é‡åˆ†æ

```python
# æ‰¹é‡åˆ†æå¤šæ¡è¯„è®º
reviews = [
    "è¿™éƒ¨ç”µå½±çœŸçš„å¾ˆæ£’ï¼Œæ¼”å‘˜æ¼”æŠ€ç²¾æ¹›ï¼",
    "å‰§æƒ…æ‹–æ²“ï¼Œæ¼”æŠ€å°´å°¬ï¼Œä¸æ¨èè§‚çœ‹ã€‚",
    "è¿˜å¯ä»¥å§ï¼Œä¸­è§„ä¸­çŸ©çš„ç”µå½±ã€‚"
]

for review in reviews:
    print(f"è¯„è®º: {review}")
    analyzer.analyze(review)
    print("-" * 50)
```

#### å®Œæ•´ç¤ºä¾‹

```python
from native_bayes_sentiment_analyzer import SentimentAnalyzer

# é…ç½®æ–‡ä»¶è·¯å¾„
model_path = './data/bayes.pkl'
userdict_path = './data/userdict.txt'
stopword_path = './data/stopwords.txt'

# åˆ›å»ºåˆ†æå™¨å®ä¾‹
analyzer = SentimentAnalyzer(
    model_path=model_path, 
    stopword_path=stopword_path, 
    userdict_path=userdict_path
)

# æµ‹è¯•è´Ÿé¢è¯„è®º
negative_text = ('å€æ„Ÿå¤±æœ›çš„ä¸€éƒ¨è¯ºå…°çš„ç”µå½±ï¼Œæ„Ÿè§‰æ›´åƒæ˜¯ç›—æ¢¦å¸®çš„ä¸€åœºå¤§æ‚çƒ©ã€‚'
                'è™½ç„¶çœ‹ä¹‹å‰å°±çŸ¥é“è‚¯å®šæ˜¯ä¸€éƒ¨æ— æ³•è¶…è¶Šå‰ä¼ 2çš„è™è ç‹­ï¼Œ'
                'ä½†çœŸå¿ƒæ²¡æƒ³åˆ°èƒ½å·®åˆ°è¿™ä¸ªåœ°æ­¥ã€‚'
                'èŠ‚å¥çš„æŠŠæ§çš„å¤±è¯¯å’Œè§’è‰²çš„å®šä½æ¨¡ç³Šç»å¯¹æ˜¯æ•´éƒ¨å½±ç‰‡çš„ç¡¬ä¼¤ã€‚')

print("è´Ÿé¢è¯„è®ºåˆ†æ:")
analyzer.analyze(negative_text)
# è¾“å‡º: å·®è¯„ï¼š 0.738 å¥½è¯„ï¼š 0.262

# æµ‹è¯•æ­£é¢è¯„è®º
positive_text = "è¿™éƒ¨ç”µå½±çœŸçš„å¾ˆæ£’ï¼Œæ¼”å‘˜æ¼”æŠ€ç²¾æ¹›ï¼Œå‰§æƒ…å¼•äººå…¥èƒœï¼Œå¼ºçƒˆæ¨èï¼"
print("\næ­£é¢è¯„è®ºåˆ†æ:")
analyzer.analyze(positive_text)
# è¾“å‡º: å·®è¯„ï¼š 0.123 å¥½è¯„ï¼š 0.877
```

### 4. è¿è¡Œç¤ºä¾‹

é¡¹ç›®æä¾›äº†å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹ï¼š

```bash
python run_test.py
```

## ğŸ“š API æ–‡æ¡£

### SentimentAnalyzer ç±»

#### åˆå§‹åŒ–å‚æ•°

- `model_path` (str): è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶è·¯å¾„
- `userdict_path` (str): ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸æ–‡ä»¶è·¯å¾„
- `stopword_path` (str): åœç”¨è¯æ–‡ä»¶è·¯å¾„

#### ä¸»è¦æ–¹æ³•

##### `analyze(text)`
åˆ†ææ–‡æœ¬æƒ…æ„Ÿå¹¶æ‰“å°ç»“æœ
- **å‚æ•°**: `text` (str) - å¾…åˆ†æçš„æ–‡æœ¬
- **è¿”å›**: Noneï¼ˆç›´æ¥æ‰“å°ç»“æœï¼‰

##### `predict_score(text_corpus)`
è¿”å›æƒ…æ„Ÿåˆ†æçš„æ¦‚ç‡å€¼
- **å‚æ•°**: `text_corpus` (list) - é¢„å¤„ç†åçš„å¥å­åˆ—è¡¨
- **è¿”å›**: numpy.ndarray - åŒ…å«[è´Ÿé¢æ¦‚ç‡, æ­£é¢æ¦‚ç‡]çš„æ•°ç»„

##### `replace_text(text)`
æ–‡æœ¬é¢„å¤„ç†å’Œæ¸…æ´—
- **å‚æ•°**: `text` (str) - åŸå§‹æ–‡æœ¬
- **è¿”å›**: list - åˆ†å‰²åçš„å¥å­åˆ—è¡¨

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### ç‰¹å¾å·¥ç¨‹

1. **æ–‡æœ¬é¢„å¤„ç†**
   - URLé“¾æ¥ç§»é™¤
   - ç‰¹æ®Šå­—ç¬¦æ¸…ç†
   - ä¸­æ–‡æ ‡ç‚¹ç¬¦å·åˆ†å¥

2. **åˆ†è¯å¤„ç†**
   - ä½¿ç”¨jiebaåˆ†è¯å™¨
   - æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰è¯å…¸
   - åœç”¨è¯è¿‡æ»¤

3. **ç‰¹å¾æå–**
   - CountVectorizer: è¯é¢‘ç»Ÿè®¡
   - TfidfTransformer: TF-IDFæƒé‡è®¡ç®—
   - å‚æ•°é…ç½®: max_df=0.8, min_df=3

### æ¨¡å‹æ¶æ„

- **ç®—æ³•**: å¤šé¡¹å¼æœ´ç´ è´å¶æ–¯ (MultinomialNB)
- **ç‰¹å¾**: TF-IDFå‘é‡
- **åˆ†ç±»**: äºŒåˆ†ç±»ï¼ˆæ­£é¢/è´Ÿé¢ï¼‰
- **è¯„ä¼°æŒ‡æ ‡**: å‡†ç¡®ç‡ (Accuracy)

### æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨Pipelineè¿›è¡Œæµæ°´çº¿å¤„ç†
- åœç”¨è¯é›†åˆåŒ–æé«˜æŸ¥æ‰¾æ•ˆç‡
- æ¨¡å‹åºåˆ—åŒ–å­˜å‚¨ï¼Œé¿å…é‡å¤è®­ç»ƒ

## ğŸ“ æ•°æ®æ–‡ä»¶è¯´æ˜

### review.csv
å½±è¯„æ•°æ®é›†ï¼Œæ ¼å¼ï¼š`æƒ…æ„Ÿæ ‡ç­¾,è¯„è®ºå†…å®¹`
- 0: è´Ÿé¢è¯„è®º
- 1: æ­£é¢è¯„è®º

### stopwords.txt
åœç”¨è¯åˆ—è¡¨ï¼Œæ¯è¡Œä¸€ä¸ªåœç”¨è¯

### userdict.txt
ç”¨æˆ·è‡ªå®šä¹‰è¯å…¸ï¼ŒåŒ…å«å½±è¯„é¢†åŸŸçš„ä¸“ä¸šè¯æ±‡

### bayes.pkl
è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- clf: æœ´ç´ è´å¶æ–¯åˆ†ç±»å™¨
- vectorizer: è¯é¢‘å‘é‡åŒ–å™¨
- tfidftransformer: TF-IDFè½¬æ¢å™¨

## ğŸ¯ åº”ç”¨åœºæ™¯

- **ç”µå½±æ¨èç³»ç»Ÿ**: åŸºäºç”¨æˆ·è¯„è®ºæƒ…æ„Ÿè¿›è¡Œä¸ªæ€§åŒ–æ¨è
- **èˆ†æƒ…ç›‘æ§**: ç›‘æ§ç”µå½±ä¸Šæ˜ åçš„ç”¨æˆ·åé¦ˆ
- **å†…å®¹å®¡æ ¸**: è‡ªåŠ¨è¯†åˆ«è´Ÿé¢è¯„è®ºè¿›è¡Œäººå·¥å®¡æ ¸
- **å¸‚åœºåˆ†æ**: åˆ†æç”µå½±å¸‚åœºåå“å’Œç”¨æˆ·åå¥½
- **è¯„åˆ†é¢„æµ‹**: ç»“åˆæƒ…æ„Ÿåˆ†æé¢„æµ‹ç”µå½±è¯„åˆ†

## ğŸš§ æ”¹è¿›æ–¹å‘

1. **æ¨¡å‹ä¼˜åŒ–**
   - å°è¯•æ·±åº¦å­¦ä¹ æ¨¡å‹ï¼ˆLSTMã€BERTç­‰ï¼‰
   - é›†æˆå¤šç§ç®—æ³•æé«˜å‡†ç¡®ç‡
   - å¢åŠ æƒ…æ„Ÿå¼ºåº¦åˆ†æ

2. **ç‰¹å¾å·¥ç¨‹**
   - æ·»åŠ è¯æ€§æ ‡æ³¨ç‰¹å¾
   - è€ƒè™‘å¥æ³•ä¾å­˜å…³ç³»
   - å¼•å…¥æƒ…æ„Ÿè¯å…¸

3. **æ•°æ®æ‰©å……**
   - å¢åŠ æ›´å¤šç”µå½±ç±»å‹çš„è¯„è®º
   - å¤„ç†æ•°æ®ä¸å¹³è¡¡é—®é¢˜
   - æ·»åŠ ç»†ç²’åº¦æƒ…æ„Ÿæ ‡ç­¾

## ğŸ“– å‚è€ƒèµ„æ–™

- [è¯¦ç»†æŠ€æœ¯åšå®¢](https://juejin.cn/post/6844903941226921991)
- [è±†ç“£å½±è¯„çˆ¬è™«é¡¹ç›®](https://github.com/3inchtime/douban_movie_review)
- [scikit-learn å®˜æ–¹æ–‡æ¡£](https://scikit-learn.org/)
- [jieba åˆ†è¯å·¥å…·](https://github.com/fxsjy/jieba)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ‘¨â€ğŸ’» ä½œè€…

- **3inchtime** - *åˆå§‹å·¥ä½œ* - [GitHub](https://github.com/3inchtime)

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢è±†ç“£ç½‘æä¾›çš„ä¸°å¯Œå½±è¯„æ•°æ®
- æ„Ÿè°¢å¼€æºç¤¾åŒºæä¾›çš„ä¼˜ç§€å·¥å…·å’Œåº“
- æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…
